<!DOCTYPE html>
<html>
<head>
    <title>Taara AI Agent</title>
    <style>
        body { font-family: Arial; max-width: 800px; margin: 50px auto; padding: 20px; }
        .container { border: 2px solid #333; padding: 20px; border-radius: 10px; }
        .allowed { color: green; }
        .blocked { color: red; }
        input, button { padding: 10px; margin: 10px 0; width: 100%; }
        #result { margin-top: 20px; padding: 10px; border: 1px solid #ccc; }
    </style>
</head>
<body>
    <div class="container">
        <h1>🌟 Taara AI Agent</h1>
        <p>⚡ ARMORIQ x OPENCLAW HACKATHON 2026</p>
        
        <div>
            <button onclick="fillCommand('Schedule a meeting tomorrow at 2pm')">✅ Schedule meeting @ 2pm</button>
            <button onclick="fillCommand('Remind me to call John at 5pm')">✅ Remind: Call John</button>
            <button onclick="fillCommand('Add task: Buy groceries')">✅ Task: Buy groceries</button>
            <button onclick="fillCommand('Delete everything from my calendar')">❌ Delete everything</button>
            <button onclick="fillCommand('What meetings do I have tomorrow?')">📅 Check schedule</button>
        </div>
        
        <input type="text" id="command" placeholder="Enter command..." value="Schedule a meeting tomorrow at 2pm">
        <button onclick="sendCommand()">Send Command</button>
        
        <div id="result"></div>
        <div id="calendar"></div>
    </div>

    <script>
    async function sendCommand() {
        const command = document.getElementById('command').value;
        const resultDiv = document.getElementById('result');
        
        resultDiv.innerHTML = 'Processing...';
        
        try {
            // Try both possible endpoints
            let response = await fetch('/api/process', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({text: command})
            });
            
            // If that fails, try the other endpoint
            if (!response.ok) {
                response = await fetch('/api/process.py', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({text: command})
                });
            }
            
            const data = await response.json();
            
            if (data.allowed) {
                resultDiv.innerHTML = '<div class="allowed">✅ ' + (data.message || 'Success') + '</div>';
            } else {
                resultDiv.innerHTML = '<div class="blocked">❌ ' + (data.message || data.reason || 'Blocked') + '</div>';
            }
            
            // Load calendar
            loadCalendar();
            
        } catch (error) {
            resultDiv.innerHTML = '<div class="blocked">❌ Error: ' + error + '</div>';
        }
    }
    
    function fillCommand(text) {
        document.getElementById('command').value = text;
        sendCommand();
    }
    
    async function loadCalendar() {
        try {
            const response = await fetch('/api/calendar');
            if (!response.ok) return;
            const data = await response.json();
            // Handle calendar data
        } catch (e) {
            // Ignore calendar errors for now
        }
    }
    </script>
</body>
</html>
